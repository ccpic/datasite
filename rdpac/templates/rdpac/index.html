<!-- extends表明此页面继承自 base.html 文件 -->
{% extends "chpa_data/base.html" %} {% load humanize %} {% load tags %}
{% block title %}RDPAC数据平台{% endblock title %}

<!-- 隐藏分隔条 -->
<div class="ui hidden divider"></div>

<!-- 写入 base.html 中定义的 body content -->
{% block body %}

<div class="ui hidden divider"></div>

<div class="ui container">
  <div id="pusher" class="pusher" style="padding-top: 50px">
    {% include 'rdpac/search_bar.html' %}
  </div>
  <div class="ui hidden divider"></div>
  <div class="ui top attached tabular menu">
    <a class="active item" data-tab="company_rank">{{ CURRENT_YEAR }} Top10 MNCs</a>
    <a class="item" data-tab="drug_rank">{{ CURRENT_YEAR }} Top10 Drugs</a>
  </div>
  <div class="ui bottom attached active tab segment" data-tab="company_rank">
    <table class="ui red table">
      <thead>
        <tr>
          <th>Rank</th>
          <th colspan="2">Company</th>
          <th>Country</th>
          <th>{{ CURRENT_YEAR }} Sales</th>
          <th>{{ CURRENT_YEAR }} Sales GR</th>
        </tr>
      </thead>
      <tbody>
        {% for company in companies_ranked %}
        <tr>
          <td>{{ forloop.counter0|add:1 }}</td>
          <td><a href="{% url 'rdpac:company_detail' company.pk %}"><img src="{{ company.logo.url }}" /></a></td>
          <td>
            <div class="item">
              <div class="middle aligned content">
                <div class="header"><a href="{% url 'rdpac:company_detail' company.pk %}">{{ company.name_cn }}</a></div>
                <div class="meta">
                  <span class="molecule_en">{{ company.name_en }}</span>
                </div>
              </div>
            </div>
          </td>
          <td><i class="{{ company.country_code }} flag"></i></td>
          <td align="right">
            {{ company.latest_annual_netsales|floatformat:"0"|intcomma }}
          </td>
          <td class="gr">
            {% if company.latest_annual_netsales_gr %}
            {{ company.latest_annual_netsales_gr|percentage:0 }}
            {% else %}
            new
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  <div class="ui bottom attached tab segment" data-tab="drug_rank">
    <table class="ui blue table">
      <thead>
        <tr>
          <th>Rank</th>
          <th>Molecule</th>
          <th>Product</th>
          <th colspan="2">Company</th>
          <th>{{ CURRENT_YEAR }} Sales</th>
          <th>{{ CURRENT_YEAR }} Sales GR</th>
        </tr>
      </thead>
      <tbody>
        {% for sales in sales_ranked %}
        <tr>
          <td>{{ forloop.counter0|add:1 }}</td>
          <td>
            <div class="item">
              <div class="middle aligned content">
                <div class="header">
                  <a href="{% url 'rdpac:drug_detail' sales.drug.pk %}">{{ sales.drug.molecule_cn }}</a>
                </div>
                <div class="meta">
                  <span class="molecule_en">{{ sales.drug.molecule_en|truncatechars:20 }}</span>
                </div>
              </div>
            </div>
          </td>
          <td>
            <div class="item">
              <div class="middle aligned content">
                <div class="header">
                  {% if sales.drug.product_name_cn %}
                  {{ sales.drug.product_name_cn }}
                  {% else %}
                  暂无中文商品名
                  {% endif %}
                </div>
                <div class="meta">
                  <span class="product_name_en">{{ sales.drug.product_name_en|truncatechars:20 }}</span>
                </div>
              </div>
            </div>
          </td>
          <td><a href="{% url 'rdpac:company_detail' sales.company.pk %}"><img src="{{ sales.company.logo.url }}" /></a></td>
          <td>
            <div class="item">
              <div class="middle aligned content">
                <div class="header"><a href="{% url 'rdpac:company_detail' sales.company.pk %}">{{  sales.company.name_cn }}</a></div>
                <div class="meta">
                  <span class="molecule_en">{{ sales.company.name_en }}</span>
                </div>
              </div>
            </div>
          </td>
          <td align="right">
            {{ sales.drug.latest_annual_netsales|floatformat:"0"|intcomma }}
          </td>
          <td class="gr">
            {% if sales.drug.latest_annual_netsales_gr %}
            {{ sales.drug.latest_annual_netsales_gr|percentage:0 }}
            {% else %}
            new
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
<div class="ui hidden divider"></div>
<style>
  .quick.link {
    color: #e9e9e9;
    cursor: pointer;
  }

  .quick.link:hover {
    color: #0d71bb;
    cursor: pointer;
  }

  .green {
    color: green;
  }

  .red {
    color: red;
  }
</style>
<style>
img{
    max-height:30px;
    max-width:100px;
    height:auto;
    width:auto;
}
</style>
<script>
  $(document).ready(function () {
    $('.menu .item')
      .tab()
    ;
    $('.gr:contains("-")').css('color', 'red');
    $('.gr:not(:contains("-"))').css('color', 'green');
  });
</script>



{% endblock body %}